<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MaiMbot çŠ¶æ€é¢æ¿ï¼ˆwith flowUsï¼‰</title>
  <style>
    :root {
      --bg: #f7f7f8;
      --card: #ffffff;
      --text: #1a1a1a;
      --muted: #6e6e73;
      --line: #e5e5e6;
      --primary-weak: #f1f1f2;
      
      --green: #22c55e;
      --green-weak: rgba(34,197,94,.12);
      --yellow: #f59e0b;
      --yellow-weak: rgba(245,158,11,.14);
      --red: #ef4444;
      --red-weak: rgba(239,68,68,.12);

      --shadow: 0 4px 12px rgba(0,0,0,.08);
      --radius: 16px;
    }
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "PingFang TC", "Hiragino Sans", sans-serif;
    }
    
    header {
      position: sticky;
      top: 0;
      z-index: 5;
      background: #111;
      border-bottom: 1px solid #333;
      color: #fff;
    }
    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px 20px;
    }
    .title {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: #444;
      box-shadow: inset 0 0 0 1px #666;
    }
    h1 {
      font-size: 20px;
      margin: 0;
    }
    .sub {
      color: #aaa;
      font-size: 13px;
    }

    .controls {
      display: grid;
      grid-template-columns: 1fr 150px 160px 150px;
      gap: 10px;
      margin: 14px 0 6px;
    }
    .controls .input, .controls select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #555;
      border-radius: 12px;
      background: #333;
      color: #fff;
      outline: none;
      box-shadow: inset 0 1px 0 rgba(0,0,0,.02);
    }
    .controls .input::placeholder {
      color: #fff;
    }

    .meta {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      color: #aaa;
      font-size: 13px;
      padding: 6px 0 10px;
    }
    .legend {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
    }
    .green { background: var(--green); }
    .yellow { background: var(--yellow); }
    .red { background: var(--red); }

    .grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 20px;
    }
    @media (max-width: 900px) {
      .controls {
        grid-template-columns: 1fr 1fr 1fr 1fr;
      }
    }
    @media (max-width: 860px) {
      .grid {
        grid-template-columns: repeat(6, 1fr);
      }
    }
    @media (max-width: 560px) {
      .grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .card {
      grid-column: span 6;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    .card-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 14px;
      background: #1c1c1e;
      color: white;
    }
    .name {
      font-weight: 700;
      font-size: 16px;
    }
    .badge {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 12px;
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.2);
    }
    .badge .dot {
      box-shadow: 0 0 0 2px rgba(255,255,255,.8) inset;
      border: 1px solid rgba(0,0,0,.06);
    }
    .badge span {
      color: white;
    }

    .info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      padding: 14px;
    }
    .row {
      display: flex;
      gap: 6px;
      align-items: flex-start;
    }
    
    .k {
      min-width: 90px;
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
    }
    
    .v {
      font-size: 14px;
    }
    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 9px;
      border-radius: 999px;
      background: var(--primary-weak);
      border: 1px solid var(--line);
      font-size: 12px;
      color: #333;
    }
    .chip .dot {
      width: 8px;
      height: 8px;
    }
    .chip.g { background: var(--green-weak); }
    .chip.y { background: var(--yellow-weak); }
    .chip.r { background: var(--red-weak); }

    details {
      border-top: 1px dashed var(--line);
      padding: 10px 14px;
      background: linear-gradient(0deg, #fafafa 0, #fff 40%);
      margin-top: auto;
    }
    details > summary {
      cursor: pointer;
      list-style: none;
    }
    details > summary::-webkit-details-marker {
      display: none;
    }
    .foot {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 14px;
      border-top: 1px solid var(--line);
      background: #fafcfd;
      color: var(--muted);
      font-size: 12px;
    }

    .pill {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      padding: 8px 14px;
      background: #333;
      color: white;
      border: 1px solid #333;
      border-radius: 999px;
      font-size: 12px;
      transition: background .2s;
    }
    .pill:hover {
      background: #111;
    }
    
    .tag {
      display: inline-flex;
      gap: 6px;
      align-items: center;
      padding: 4px 8px;
      border: 1px solid var(--line);
      border-radius: 999px;
      font-size: 11px;
      color: var(--muted);
      background: var(--bg);
    }
    #signature.tag {
      color: #aaa;
      background: #333;
      border-color: #555;
    }
    
    /* åŠ è½½æŒ‡ç¤ºå™¨ */
    .loader {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
      grid-column: 1 / -1;
    }
    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(0,0,0,0.1);
      border-radius: 50%;
      border-top-color: #3498db;
      animation: spin 1s ease-in-out infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* æ—¥å¿—æŸ¥çœ‹å™¨æ ·å¼ */
    .log-container {
      margin-top: 10px;
      border-top: 1px dashed var(--line);
      padding-top: 10px;
    }
    .log-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.2s;
    }
    .log-toggle:hover {
      background: #2980b9;
    }
    .log-iframe {
      width: 100%;
      height: 300px;
      border: 1px solid var(--line);
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }
    .log-iframe.active {
      display: block;
    }

    /* æ•°æ®æºçŠ¶æ€ */
    .data-source {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #e9ecef;
      font-size: 14px;
    }
    .data-source .status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }
    .status.loading {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }
    .status.success {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="title">
        <div>
          <h1>MaiMbot çŠ¶æ€é¢æ¿ï¼ˆwith flowUsï¼‰</h1>
          <div class="sub" id="update-date">MaiMbotçŠ¶æ€å¯è§†åŒ–é¡µé¢|æ•°æ®åŠ è½½ä¸­...</div>
        </div>
      </div>
      <div class="controls">
        <input id="q" class="input" placeholder="æœç´¢:åå­— / æ¨¡å‹ / è®¾å®š / å¤‡æ³¨ / éƒ¨ç½²è€…â€¦" />
        <select id="state">
          <option value="all">çŠ¶æ€(å…¨éƒ¨)</option>
          <option value="green">ğŸŸ¢ ç¨³å®š</option>
          <option value="yellow">ğŸŸ¡ é—´æ­‡</option>
          <option value="red">ğŸ”´ åœæœº</option>
        </select>
        <select id="family">
          <option value="all">æ¨¡å‹å®¶æ—(å…¨éƒ¨)</option>
          <option>DeepSeek</option>
          <option>ChatGPT</option>
          <option>Google</option>
          <option>Claude</option>
          <option>Grok</option>
          <option>Other</option>
        </select>
        <select id="feature">
          <option value="all">æ’ä»¶ç­›é€‰ï¼ˆå…¨éƒ¨ï¼‰</option>
          <option value="draw-on">ç»˜å›¾:å·²å¯ç”¨</option>
          <option value="mute-on">ç¦è¨€:å·²å¯ç”¨</option>
          <option value="tts-on">TTS:å¯ç”¨/å¾…å¼€å‘</option>
        </select>
      </div>
      <div class="meta">
        <div id="count">å…± 0 ä¸ª bot</div>
        <div class="legend">
          <span class="dot green"></span>ç¨³å®š
          <span class="dot yellow" style="margin-left:10px"></span>é—´æ­‡
          <span class="dot red" style="margin-left:10px"></span>åœæœº
        </div>
        <div style="flex:1"></div>
        <div id="signature" class="tag" title="ç½²å" style="display:none"></div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="data-source">
      <strong>æ•°æ®æº:</strong> FlowUs API 
      <span id="api-status" class="status loading">æ­£åœ¨è¿æ¥...</span>
      <span id="last-update" style="margin-left: 15px; font-size: 12px; color: #666;"></span>
    </div>

    <div id="grid" class="grid">
      <div class="loader">
        <div class="spinner"></div>
        <div style="margin-left: 15px; font-size: 16px; color: #666;">æ­£åœ¨ä» FlowUs åŠ è½½ MaiMbot æ•°æ®...</div>
      </div>
    </div>
  </main>

  <script>
    // å…¨å±€å˜é‡å­˜å‚¨æ•°æ®
    let globalData = null;
    let globalMeta = null;
    
    // FlowUs API é…ç½®
    const FLOWUS_API_URL = 'https://api.flowus.cn/v1/databases/4b9cf106-7498-4452-959e-fd68a678b00a/query';
    const FLOWUS_TOKEN = 'r7npMvCZqFOcMzm9Nuyj1LnuDPeEoh9s4WVmPBph';

    // ä»FlowUs APIåŠ è½½æ•°æ®
    async function loadBotDataFromFlowUs() {
      try {
        updateApiStatus('loading', 'æ­£åœ¨è¯·æ±‚æ•°æ®...');
        
        const response = await fetch(FLOWUS_API_URL, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${FLOWUS_TOKEN}`,
            'Content-Type': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const flowusData = await response.json();
        updateApiStatus('success', 'æ•°æ®åŠ è½½æˆåŠŸ');
        
        // è½¬æ¢FlowUsæ•°æ®ä¸ºæˆ‘ä»¬çš„æ ¼å¼
        return convertFlowUsData(flowusData);
      } catch (error) {
        console.error('ä»FlowUsåŠ è½½æ•°æ®å¤±è´¥:', error);
        updateApiStatus('error', `åŠ è½½å¤±è´¥: ${error.message}`);
        throw error;
      }
    }

    // è½¬æ¢FlowUsæ•°æ®æ ¼å¼
    function convertFlowUsData(flowusData) {
      const bots = flowusData.results.map(page => {
        const props = page.properties;
        
        // è·å–æ ‡é¢˜ï¼ˆæœºå™¨äººåç§°ï¼‰
        const name = props.title?.title?.[0]?.plain_text || 'æœªçŸ¥åç§°';
        
        // è·å–çŠ¶æ€
        const statusText = props['å½“å‰çŠ¶æ€_statusText']?.select?.name || 'ğŸŸ¡ çŠ¶æ€æœªçŸ¥';
        
        // è·å–èŠå¤©æ¨¡å‹ï¼ˆå¤šé€‰ï¼‰
        const chatModel = props['èŠå¤©æ¨¡å‹_chatModel']?.multi_select?.map(item => item.name).join(' + ') || '';
        
        // è·å–è§†è§‰æ¨¡å‹ï¼ˆå¤šé€‰ï¼‰
        const vlmModel = props['è¯†å›¾æ¨¡å‹_vlmModel']?.multi_select?.map(item => item.name).join(' + ') || '';
        
        // è·å–éƒ¨ç½²è€…ï¼ˆå¤šé€‰ï¼‰
        const deployer = props['éƒ¨ç½²è€…_deployer']?.multi_select?.map(item => item.name).join(' | ') || '';
        
        // è·å–ç‰ˆæœ¬
        const version = props['éº¦éº¦ç‰ˆæœ¬å·_version']?.select?.name || '';
        
        // è·å–æ—¥å¿—URL - ä¿®æ­£å±æ€§å
        const logUrl = props['å†…åµŒæ—¥å¿—é¡µï¼ˆéœ€è¦å…¬ç½‘å¯è®¿é—®ï¼‰_logUrl']?.url || '';
        
        // è§£ææ’ä»¶æ•°æ®
        let plugins = [];
        const pluginsText = props['æ’ä»¶å¯ç”¨æƒ…å†µ_plugins']?.rich_text?.[0]?.plain_text;
        if (pluginsText) {
          try {
            // æ¸…ç†æ’ä»¶æ–‡æœ¬å¹¶è§£æä¸ºæ•°ç»„
            const cleanedText = pluginsText.trim().replace(/,\s*$/, '');
            plugins = JSON.parse(`[${cleanedText}]`);
          } catch (e) {
            console.warn(`è§£ææ’ä»¶æ•°æ®å¤±è´¥ (${name}):`, e);
          }
        }
        
        // è§£æè®¾å®šæè¿°
        let setting = [];
        const settingText = props['è®¾å®šæè¿°_setting']?.rich_text?.[0]?.plain_text;
        if (settingText) {
          // ç®€å•çš„åˆ†å‰²é€»è¾‘ï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
          setting = settingText.split('","').map(s => s.replace(/"/g, '').trim());
        }
        
        // è·å–å¤‡æ³¨
        const note = props['å…¶ä»–æ³¨é‡Š_note']?.rich_text?.[0]?.plain_text || '';

        return {
          name,
          statusText,
          chatModel,
          vlmModel,
          other: "",
          setting,
          plugins,
          version,
          deployer,
          note,
          logUrl
        };
      });

      // åˆ›å»ºmetaä¿¡æ¯
      const meta = {
        signature: "ç”±:ç»æœ›çš„äººç±»çŸ³æ¥ å­nana|æ”¹ä¸æ˜ç™½è‡ªå·±bugçš„GPT-5 Thinking|è‰²ç›²çš„Gemini2.5Pro è”åˆåˆ¶ä½œ",
        updated: new Date().toISOString().split('T')[0]
      };

      // ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¾¿äºæ’æŸ¥,è°ƒè¯•ä½¿ç”¨ï¼Œtest
      saveDataToLocal({ meta, bots });

      return { meta, bots };
    }

    // ä¿å­˜æ•°æ®åˆ°æœ¬åœ°æ–‡ä»¶
    function saveDataToLocal(data) {
      try {
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `maimbot_status_${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        console.log('æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶');
      } catch (error) {
        console.warn('ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶å¤±è´¥:', error);
      }
    }

    // æ›´æ–°APIçŠ¶æ€æ˜¾ç¤º
    function updateApiStatus(status, message) {
      const statusEl = document.getElementById('api-status');
      const lastUpdateEl = document.getElementById('last-update');
      
      statusEl.className = `status ${status}`;
      statusEl.textContent = message;
      
      if (status === 'success') {
        lastUpdateEl.textContent = `æœ€åæ›´æ–°: ${new Date().toLocaleString()}`;
      }
    }

    // åˆå§‹åŒ–å‡½æ•°
    async function init() {
      try {
        const data = await loadBotDataFromFlowUs();
        globalData = data.bots;
        globalMeta = data.meta;
        
        // æ›´æ–°é¡µé¢ä¿¡æ¯
        document.getElementById('update-date').textContent = 
          `MaiMbotçŠ¶æ€å¯è§†åŒ–é¡µé¢|æˆªæ­¢æ—¶é—´:${globalMeta.updated}`;
        
        if (globalMeta.signature) {
          const sigEl = document.getElementById('signature');
          sigEl.textContent = globalMeta.signature;
          sigEl.style.display = 'inline-flex';
        }
        
        // æ¸²æŸ“åˆå§‹è§†å›¾
        render();
      } catch (error) {
        console.error('åˆå§‹åŒ–å¤±è´¥:', error);
        document.getElementById('grid').innerHTML = `
          <div style="grid-column:1/-1;text-align:center;padding:40px;color:#666">
            <h3>æ•°æ®åŠ è½½å¤±è´¥</h3>
            <p>${error.message}</p>
            <p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•</p>
          </div>
        `;
      }
    }

    // æ¸²æŸ“å‡½æ•°
    function render() {
      if (!globalData) return;
      
      const q = document.getElementById('q').value.trim().toLowerCase();
      const st = document.getElementById('state').value;
      const fam = document.getElementById('family').value;
      const feat = document.getElementById('feature').value;

      const matchFeat = (bot) => {
        if (feat === 'all') return true;
        const P = (k) => bot.plugins.find(p=>p.k.toLowerCase().includes(k.toLowerCase()));
        if (feat === 'draw-on') {
          const drawPlugin = P('ç»˜å›¾') || P('ç”Ÿå›¾');
          return (drawPlugin && drawPlugin.lvl === 'g');
        }
        if (feat === 'mute-on') {
          const mutePlugin = P('ç¦è¨€');
          return (mutePlugin && (mutePlugin.lvl === 'g' || mutePlugin.lvl === 'y'));
        }
        if (feat === 'tts-on') {
          const ttsPlugin = P('TTS');
          return (tttsPlugin && (ttsPlugin.lvl === 'g' || ttsPlugin.lvl === 'y'));
        }
        return true;
      }

      const list = globalData.filter(b=>{
        const f1 = (st==='all') || (stateLevel(b.statusText)===st);
        const f2 = (fam==='all') || (famOf(b.chatModel)===fam);
        const hay = [b.name,b.statusText,b.chatModel,b.vlmModel,b.other,(b.setting||[]).join(' '),b.version,b.deployer,b.note].join(' ').toLowerCase();
        const f3 = !q || hay.includes(q);
        const f4 = matchFeat(b);
        return f1 && f2 && f3 && f4;
      });

      count.textContent = `å…± ${list.length} ä¸ª bot`;
      
      if (list.length === 0) {
        grid.innerHTML = `
          <div style="grid-column:1/-1;text-align:center;padding:40px;color:#666">
            <h3>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ MaiMbot</h3>
            <p>å°è¯•æ›´æ”¹ç­›é€‰æ¡ä»¶æˆ–æœç´¢å…³é”®è¯</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = list.map(b=>{
        const lvl = stateLevel(b.statusText);
        const fam = famOf(b.chatModel);
        const pluginChips = (b.plugins||[]).map(p=>{
          const cls = p.lvl==='g'?'g':p.lvl==='y'?'y':'r';
          return `<span class="chip ${cls}"><span class="dot ${cls==='g'?'green':cls==='y'?'yellow':'red'}"></span>${p.k}Â·${p.v}</span>`
        }).join('');
        const settings = (b.setting||[]).map(s=>`<li>${s}</li>`).join('');
        
        // æ—¥å¿—æŸ¥çœ‹æŒ‰é’®å’Œiframe - å·²æ¢å¤
        const logSection = b.logUrl ? `
          <div class="log-container">
            <button class="log-toggle" data-url="${b.logUrl}">
              ğŸ“‹ æŸ¥çœ‹æ—¥å¿—
            </button>
            <iframe class="log-iframe" data-url="${b.logUrl}" sandbox="allow-same-origin allow-scripts"></iframe>
          </div>
        ` : '';
        
        return `
        <article class="card">
          <div class="card-head">
            <div class="name">${b.name}</div>
            <div class="badge"><span class="dot ${lvl}"></span><span>${b.statusText.replace(/[ğŸŸ¢ğŸŸ¡ğŸ”´]/g, '').trim()}</span></div>
          </div>
          <div class="info">
            <div class="row"><div class="k">Chat Model</div><div class="v">${b.chatModel}</div></div>
            <div class="row"><div class="k">VLM Model</div><div class="v">${b.vlmModel||'-'}</div></div>
            ${b.other?`<div class="row"><div class="k">Other</div><div class="v">${b.other}</div></div>`:''}
            <div class="row"><div class="k">æ¨¡å‹å®¶æ—</div><div class="v"><span class="tag" data-fam="${fam}">${fam}</span></div></div>
            <div class="row" style="grid-column:1/-1"><div class="k">æ’ä»¶</div><div class="v chips">${pluginChips||'-'}</div></div>
          </div>
          <details>
            <summary><span class="pill">å±•å¼€è¯¦ç»†ä¿¡æ¯</span></summary>
            <div style="padding-top:10px">
              <div class="row"><div class="k">è®¾å®š/äººè®¾</div><div class="v"><ul style="margin:0;padding-left:18px">${settings}</ul></div></div>
              <div class="row" style="margin-top:6px"><div class="k">å¤‡æ³¨</div><div class="v">${b.note||'-'}</div></div>
              ${logSection}
            </div>
          </details>
          <div class="foot">
            <div>ç‰ˆæœ¬:${b.version}</div>
            <div>éƒ¨ç½²è€…:${b.deployer||'-'}</div>
          </div>
        </article>`;
      }).join('');
      
      // æ·»åŠ æ—¥å¿—æŸ¥çœ‹äº‹ä»¶ç›‘å¬
      attachLogViewListeners();
    }

    // æ·»åŠ æ—¥å¿—æŸ¥çœ‹äº‹ä»¶ç›‘å¬
    function attachLogViewListeners() {
      const logToggles = document.querySelectorAll('.log-toggle');
      logToggles.forEach(toggle => {
        toggle.addEventListener('click', function(e) {
          e.stopPropagation();
          const url = this.getAttribute('data-url');
          const iframe = this.nextElementSibling;
          
          if (iframe.classList.contains('active')) {
            // å…³é—­æ—¥å¿—
            iframe.classList.remove('active');
            this.textContent = 'ğŸ“‹ æŸ¥çœ‹æ—¥å¿—';
          } else {
            // æ‰“å¼€æ—¥å¿—
            iframe.src = url;
            iframe.classList.add('active');
            this.textContent = 'ğŸ“‹ éšè—æ—¥å¿—';
          }
        });
      });
    }

    // è¾…åŠ©å‡½æ•°
    const famOf = (chatModel) => {
      const s = (chatModel||'').toLowerCase();
      if (s.includes('deepseek')) return 'DeepSeek';
      if (s.includes('chatgpt') || s.includes('gpt-4')) return 'ChatGPT';
      if (s.includes('gemini') || s.includes('gemma')) return 'Google';
      if (s.includes('claude')) return 'Claude';
      if (s.includes('grok')) return 'Grok';
      return 'Other';
    };

    const stateLevel = (statusText) => {
      const s = statusText||'';
      if (s.includes('ğŸŸ¢')) return 'green';
      if (s.includes('ğŸŸ¡')) return 'yellow';
      if (s.includes('ğŸ”´')) return 'red';
      return 'yellow';
    };

    // ç»‘å®šç­›é€‰å™¨äº‹ä»¶
    ['q','state','family','feature'].forEach(id=>{
      document.getElementById(id).addEventListener('input', render);
      document.getElementById(id).addEventListener('change', render);
    });

    // åˆå§‹åŒ–åº”ç”¨ - ä»FlowUs APIåŠ è½½
    init();
  </script>
</body>
</html>